# ğŸ¤– ChatGLMæœ¬åœ°æ¨¡å‹éƒ¨ç½²

## ğŸš€ ChatGLM2-6B

### ğŸ“– ChatGLM2-6B ç®€ä»‹

ChatGLM2-6B æ˜¯å¼€æºä¸­è‹±åŒè¯­å¯¹è¯æ¨¡å‹ ChatGLM-6B çš„ç¬¬äºŒä»£ç‰ˆæœ¬ï¼Œå…·ä½“ä»‹ç»å¯å‚é˜… [ChatGLM2-6B é¡¹ç›®ä¸»é¡µ](https://github.com/THUDM/ChatGLM2-6B)

::: warning âš ï¸ æ³¨æ„
ChatGLM2-6B æƒé‡å¯¹å­¦æœ¯ç ”ç©¶å®Œå…¨å¼€æ”¾ï¼Œåœ¨è·å¾—å®˜æ–¹çš„ä¹¦é¢è®¸å¯åï¼Œäº¦å…è®¸å•†ä¸šä½¿ç”¨ã€‚æœ¬æ•™ç¨‹åªæ˜¯ä»‹ç»äº†ä¸€ç§ç”¨æ³•ï¼Œæ— æƒç»™äºˆä»»ä½•æˆæƒï¼
:::

### ğŸ’» æ¨èé…ç½®

ä¾æ®å®˜æ–¹æ•°æ®ï¼ŒåŒæ ·æ˜¯ç”Ÿæˆ 8192 é•¿åº¦ï¼Œé‡åŒ–ç­‰çº§ä¸º FP16 è¦å ç”¨ 12.8GB æ˜¾å­˜ã€int8 ä¸º 8.1GB æ˜¾å­˜ã€int4 ä¸º 5.1GB æ˜¾å­˜ï¼Œé‡åŒ–åä¼šç¨å¾®å½±å“æ€§èƒ½ï¼Œä½†ä¸å¤šã€‚

| ç±»å‹ | å†…å­˜           | æ˜¾å­˜           | ç¡¬ç›˜ç©ºé—´       |
| ------ | ---------------- | ---------------- | ---------------- |
| fp16 | \>\=16GB | \>\=16GB | \>\=25GB |
| int8 | \>\=16GB | \>\=9GB  | \>\=25GB |
| int4 | \>\=16GB | \>\=6GB  | \>\=25GB |

### ğŸ› ï¸ æºç éƒ¨ç½²

::: tip ğŸ’¡ æç¤º
æ ¹æ®ä¸Šé¢çš„ç¯å¢ƒé…ç½®é…ç½®å¥½ç¯å¢ƒï¼Œå…·ä½“æ•™ç¨‹è‡ªè¡Œç™¾åº¦ï¼›
å¯å‚è€ƒçš„éƒ¨ç½²æ–‡ç« : [https://blog.csdn.net/lovelylord/article/details/132349967](https://blog.csdn.net/lovelylord/article/details/132349967)
:::

* **1ï¸âƒ£ ä»GitHubä»“åº“ä¸­æ‹‰å–ä»£ç **

```bash
# 1.ä»GitHubä»“åº“ä¸­æ‹‰å–ä»£ç 
git clone https://github.com/THUDM/ChatGLM2-6B

# 2.è¿›å…¥ä¸‹è½½æºç çš„ç›®å½•
cd ChatGLM2-6B
```

* **2ï¸âƒ£ ä¸‹è½½pythonæ–‡ä»¶ï¼š**  [ğŸ“¥ ç‚¹å‡»ä¸‹è½½Pythonæ–‡ä»¶](https://doc.chatmoney.cn/docs/download/glm.zip)

    * å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶: openai_ai.py å’Œ requirements.txt
    * æŠŠè¿™ä¸¤ä¸ªæ–‡ä»¶æ›¿æ¢åˆ° ChatGLM2-6B ç›®å½•é‡Œé¢
* **3ï¸âƒ£ å®‰è£…ä¾èµ–ï¼š**  **â€‹`pip install -r requirments.txt`â€‹**

    * å»ºè®®ä½¿ç”¨pythonçš„è™šæ‹Ÿç¯å¢ƒ,ä»¥å…äº§ç”Ÿä¸€äº›ä¸å¿…è¦çš„éº»çƒ¦ã€‚
* **4ï¸âƒ£ è¿è¡Œé¡¹ç›®ï¼š**  **â€‹`python openai_api.py --model 16`â€‹** **è¿™é‡Œçš„æ•°å­—æ ¹æ®ä¸Šé¢çš„é…ç½®è¿›è¡Œé€‰æ‹©ã€‚**

    * ç„¶åç­‰å¾…æ¨¡å‹ä¸‹è½½ï¼Œç›´åˆ°æ¨¡å‹åŠ è½½å®Œæ¯•ä¸ºæ­¢ã€‚å¦‚æœå‡ºç°æŠ¥é”™å…ˆé—®ç™¾åº¦ã€‚
    * è¿™é‡Œå¯èƒ½éœ€è¦ç§‘å­¦ä¸Šç½‘
* **5ï¸âƒ£ å¯åŠ¨æˆåŠŸååº”è¯¥ä¼šæ˜¾ç¤ºå¦‚ä¸‹åœ°å€ï¼š**

::: tip ğŸ’¡ æç¤º
è¿™é‡Œçš„ [http://0.0.0.0:8000](http://0.0.0.0:8000/) å°±æ˜¯è¿æ¥åœ°å€ã€‚
:::

![å¯åŠ¨ç•Œé¢](https://doc.chatmoney.cn/docs/images/general/third-deployment/chat-glm/chatglm-start.png)

### âš™ï¸ å…³äº openai_api.py å¯åŠ¨å‚æ•°

| å‚æ•°å   | å¯é€‰å€¼                                                             | é»˜è®¤å€¼ |
| ---------- | -------------------------------------------------------------------- | -------- |
| --device | cuda\=æ˜¾å¡è¿è¡Œ, cpu\=cpuè¿è¡Œ                                 | cuda   |
| --path   | local\=æœ¬åœ°ä¸‹è½½çš„æ¨¡å‹è¿è¡Œ, thudm\=çº¿ä¸Šè‡ªåŠ¨ä¸‹è½½               | thudm  |
| --model  | 4\=chatglm2-6b-int4, 8\=chatglm2-6b-int8, 16\=chatglm2-6b | 16     |

* ğŸ“ è¯´æ˜:
    * å¦‚æœä½  `--path` å‚æ•°è®¾ç½®ä¸º local, é‚£éœ€è¦ä½ å…ˆæŠŠæ¨¡å‹ä¸‹è½½ä¸‹æ¥, æ”¾åˆ° ChatGLM2-6B/models ç›®å½•ä¸‹
    * æ¯”å¦‚: ChatGLM2-6B/models/chatglm2-6b-int4
    * ç„¶åå†å»è¿è¡Œ: `python openai_api.py --model 4 --path local`

### ğŸ§ª æ¥å£æµ‹è¯•

![æ¥å£æµ‹è¯•](https://doc.chatmoney.cn/docs/images/general/third-deployment/chat-glm/chatglm-post.png)

### ğŸ”— æ¥å…¥åˆ°ç³»ç»Ÿ

![ç³»ç»Ÿæ¥å…¥](https://doc.chatmoney.cn/docs/images/general/third-deployment/chat-glm/chatglm-set.png)

## ğŸš€ ChatGLM3-6B

::: warning âš ï¸ æ³¨æ„
éƒ¨ç½²æ–¹æ¡ˆå’ŒChatGLM2-6Bçš„æ–¹å¼åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ã€‚
:::

* **1ï¸âƒ£ ä»GitHubä»“åº“ä¸­æ‹‰å–ä»£ç **

```bash
# 1.ä»GitHubä»“åº“ä¸­æ‹‰å–ä»£ç 
https://github.com/THUDM/ChatGLM3

# 2.è¿›å…¥ä¸‹è½½æºç çš„ç›®å½•
cd ChatGLM3-6B
```

// ... ä¸­é—´éƒ¨åˆ†ä¿æŒä¸å˜ ...

* **8ï¸âƒ£ å…³äº openai_api.py å¯åŠ¨å‚æ•°**

| å‚æ•°å   | å¯é€‰å€¼                                                                              | é»˜è®¤å€¼ |
| ---------- | ------------------------------------------------------------------------------------- | -------- |
| --device | cuda\=æ˜¾å¡è¿è¡Œ, cpu\=cpuè¿è¡Œ                                                  | cuda   |
| --path   | local\=æœ¬åœ°ä¸‹è½½çš„æ¨¡å‹è¿è¡Œ, thudm\=çº¿ä¸Šè‡ªåŠ¨ä¸‹è½½                                | thudm  |
| --model  | 4\=é‡åŒ–æ¨¡å‹, 16\=chatglm3-6b, 32\=chatglm2-6b-32k, 128\=chatglm2-6b-32k | 4      |

* ğŸ“ è¯´æ˜:
    * å¦‚æœä½  `--path` å‚æ•°è®¾ç½®ä¸º local, é‚£éœ€è¦ä½ å…ˆæŠŠæ¨¡å‹ä¸‹è½½ä¸‹æ¥, æ”¾åˆ° ChatGLM2-6B/models ç›®å½•ä¸‹
    * æ¯”å¦‚: ChatGLM3-6B/models/chatglm3-6b
    * ç„¶åå†å»è¿è¡Œ: `python openai_api.py --model 4 --path local`
    * ğŸ’¡ æ¸©é¦¨å°æç¤ºï¼šGLM3ä¸å†åƒä¹‹å‰GLM2é‚£æ ·å•ç‹¬æä¾›é‡åŒ–ç‰ˆæœ¬æ¨¡å‹ä¸‹è½½ï¼Œç°åœ¨æ˜¯é‡åŒ–æ¨¡å‹ç›´æ¥ç»§æ‰¿åœ¨ chatglm3-6bæ¨¡å‹ä¸Šï¼Œä½¿ç”¨è¿è¡Œå‘½ä»¤ä½œä¸ºåŒºåˆ†ã€‚